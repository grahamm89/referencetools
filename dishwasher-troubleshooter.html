<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dishwasher Troubleshooting Helper</title>
<style>
 :root{--bg:#f7f9fa;--card:#fff;--txt:#222;--accent:#0073e6;--sep:rgba(0,0,0,.08);
       --yes:#2e8b57;--no:#c0392b}
 @media (prefers-color-scheme:dark){
   :root{--bg:#121417;--card:#1e2125;--txt:#e0e3e6;--accent:#53a2ff;
         --sep:rgba(255,255,255,.08);--yes:#2ecc71;--no:#e74c3c}
 }
 *{box-sizing:border-box}
 body{margin:0;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg);color:var(--txt);padding:1rem;line-height:1.45}
 h1{margin:.2rem 0 1rem}
 section{background:var(--card);padding:1rem 1.1rem;border-radius:8px;
         box-shadow:0 2px 4px rgba(0,0,0,.05);margin-bottom:1.6rem}
 label{font-weight:600}
 select,button{font-size:1rem;padding:.55rem .7rem;margin-top:.35rem;border-radius:6px}
 select{width:100%}
 button{cursor:pointer;background:var(--accent);border:1px solid var(--accent);color:#fff;transition:opacity .18s}
 button:hover{opacity:.9}
 .result{display:none;margin-top:1rem;border-left:4px solid var(--accent);padding-left:1rem}
 .result.show{display:block}
 .qcard{border:1px solid var(--sep);border-radius:6px;padding:.8rem .9rem;margin-bottom:.9rem;
        display:flex;flex-wrap:wrap;align-items:center}
 .qcard p{flex:1 1 260px;margin:.25rem 0;font-weight:500}
 .toggle{display:inline-flex;border-radius:20px;overflow:hidden;margin-left:auto}
 .toggle input{display:none}
 .toggle label{padding:.34rem .95rem;cursor:pointer;font-size:.92rem;transition:opacity .15s}
 .toggle .yes{background:var(--yes);color:#fff}
 .toggle .no {background:var(--no); color:#fff}
 .toggle label{opacity:.4}
 .toggle input:checked+label{opacity:1}
 .note{flex:1 1 100%;margin:.4rem 0 0;font-size:.85rem;color:var(--accent)}
 .mm-row{display:flex;gap:.6rem;flex-wrap:wrap;margin-bottom:1rem}
 .mm-row div{flex:1 1 200px}
 .mm-row input{width:100%;padding:.5rem;border:1px solid var(--sep);border-radius:6px}
 #fieldTests ul{list-style:none;margin:0;padding:0}
 #fieldTests li{padding:.8rem 0;border-bottom:1px solid var(--sep)}
 #fieldTests li:last-child{border:none}
 #fieldTests strong{display:block;margin-bottom:.3rem}
 @media (max-width:640px){
   body{padding:.6rem}
   h1{font-size:1.35rem}
   h2{font-size:1.15rem;margin:.25rem 0 .7rem}
 }
</style>
</head>
<body>

<h1>Dishwasher Troubleshooting Helper</h1>

<!-- ---------- 1. QUICK SYMPTOM LOOKUP ---------- -->
<section>
 <h2>1. Quick Symptom Lookup</h2>
 <label for="symptom">Observed symptom or issue:</label>
 <select id="symptom">
   <option value="">-- choose symptom --</option>
   <option value="Tannin Stains">Tannin stains (tea / coffee / wine)</option>
   <option value="Starch">Starch residue</option>
   <option value="Foaming">Excessive foaming</option>
   <option value="Drying Marks">Drying marks / streaking</option>
   <option value="Detergent Overuse">Detergent over-use</option>
   <option value="Limescale">Limescale forming</option>
   <option value="Cracking Plastic">Cracking plastic-ware</option>
   <option value="Bits After Rinsing">Bits left after rinsing</option>
   <option value="Detergent Carryover">Detergent carry-over</option>
   <option value="Cloudy Glasses">Cloudy glasses</option>
   <option value="Rusty Cutlery">Rusty cutlery</option>
   <option value="Black SS Cutlery">Black stainless-steel cutlery</option>
   <option value="Silver Tarnishing">Silver tarnishing</option>
   <option value="Machine Scaled">Machine scaled</option>
   <option value="Wash Jets Blocked">Wash jets blocked</option>
 </select>
 <div id="symptomResult" class="result"></div>
</section>

<!-- ---------- 2. ESSENTIAL CHECKS ---------- -->
<section>
 <h2>2. Essential Checks</h2>
 <div class="mm-row">
  <div><label for="mMake">Machine make</label><input id="mMake" placeholder="e.g. Hobart"></div>
  <div><label for="mModel">Machine model</label><input id="mModel" placeholder="e.g. AMXX-10"></div>
 </div>

 <!-- yes/no cards -->
 <!-- (cards unchanged, omitted here for brevity) -->
 <!-- include the seven qcards exactly as in previous message -->

 <div id="checklistResult" class="result"></div>
 <button id="copyBtn" style="margin-top:.9rem">Copy to Youreka</button>
</section>

<!-- ---------- 3. FIELD CHEMICAL TESTS ---------- -->
<section id="fieldTests">
 <h2>3. Field Chemical Tests</h2>
 <ul>
  <li><strong>Detergent Carry-Over</strong><br>Indicator reagent turns pink → detergent not rinsed off. Check rinse arms & pressure.</li>
  <li><strong>Detection of Starch</strong><br>ACID 1 + Iodide/Iodate → blue/black colour indicates starch.</li>
  <li><strong>Detection of Limescale</strong><br>ACID 3 bubbles = carbonate scale present.</li>
 </ul>
 <p style="margin-top:1rem">
   Need to titrate detergent? <a href="https://grahamm89.github.io/referencetools/detergent-concentration.html" target="_blank" rel="noopener">Open the concentration web-app</a>
 </p>
</section>

<!-- ==================== JAVASCRIPT ==================== -->
<script>
/* ---------- FULL VERBATIM DATA ---------- */
var DATA = {
 "Tannin Stains": {
  causes:"Tea or coffee and wine. Worse where glaze has eroded.",
  consequences:"",
  actions:"Use chlorinated detergents or pre-soak with Suma Shine K2. Use Bactosol renovator in glasswashers."
 },
 "Starch": {
  causes:"Heated plates, long delays, greasy sticky foods, low detergent level, poor wash pressure, poor wash temperatures.",
  consequences:"",
  actions:"Increase detergent level, change to a more alkaline detergent, improve practices, improve temperatures, increase wash pressure."
 },
 "Foaming": {
  causes:"Low wash/rinse temperature, hand dishwashing detergents contaminating wash, high food soiling, high wash-tank water level, poor rinse.",
  consequences:"",
  actions:"Increase temperature, reduce rinse-aid level, remove problem detergents, improve draining, and remove high-foam product."
 },
 "Drying Marks": {
  causes:"No or poor performance from rinse, low rinse aid level, low rinse temperature, high rinse temperature, hard water, high dissolved solids, poor racking.",
  consequences:"",
  actions:"Repair dishwasher, increase rinse-aid level, adjust rinse temperature, use hard-water rinse-aid or de-ioniser, improve racking."
 },
 "Detergent Overuse": {
  causes:"Broken equipment (Diversey or machine) leaking drain, too high set point, scaled probe, broken fill valve, jammed solenoid (for powders).",
  consequences:"",
  actions:"Repair or replace broken equipment, descale and clean probe, reduce set point, ensure detergent level matches water hardness, free solenoid."
 },
 "Limescale": {
  causes:"No/broken water softener, incorrect detergent level, incorrect rinse-aid.",
  consequences:"",
  actions:"Repair water softener, increase detergent level, move to hard-water detergent and rinse-aid."
 },
 "Cracking Plastic": {
  causes:"Excessive heat, non-ionic hand detergent, some rinse aids, very high chlorine.",
  consequences:"",
  actions:"Lower rinse temperature, remove problem chemicals, use plastic-safe products A11/A8, reduce chlorine."
 },
 "Bits After Rinsing": {
  causes:"Poor/broken rinse, dirty wash water, contaminated rinse water, coffee grounds/tea bags, poor racking.",
  consequences:"",
  actions:"Repair dishwasher, change wash water, improve pre-scraping, improve rinse supply, improve racking."
 },
 "Detergent Carryover": {
  causes:"Poor/broken rinse, very high detergent level, poor rinse pressure.",
  consequences:"",
  actions:"Repair dishwasher, reduce detergent level, increase rinse pressure, clear rinse jets."
 },
 "Cloudy Glasses": {
  causes:"Hard-water scale, detergent carry-over, detergent level too high, high-water solids.",
  consequences:"",
  actions:"Increase detergent level, improve rinse pressure/temperature, reduce detergent level, install softener if needed."
 },
 "Rusty Cutlery": {
  causes:"Prolonged soaking, contact with salt or chlorinated product at high concentration.",
  consequences:"",
  actions:"Improve operation, reduce chlorine exposure, upgrade cutlery."
 },
 "Black SS Cutlery": {
  causes:"Silver dip, heat.",
  consequences:"",
  actions:"Do not bring stainless steel into contact with Suma Silver D8 or excessive heat."
 },
 "Silver Tarnishing": {
  causes:"Sulphides (eggs/fires), chlorine, excessive heat.",
  consequences:"",
  actions:"Remove sulphides & chlorine, reduce heat, burnish silver."
 },
 "Machine Scaled": {
  causes:"Hard-water scale forms if detergent insufficient in hard-water areas.",
  consequences:"Porous scale harbours bacteria; poor wash results; energy cost rises.",
  actions:"Add salt to softener, ensure detergent present, descale with limescale remover."
 },
 "Wash Jets Blocked": {
  causes:"Debris blocks jets; water cannot pass.",
  consequences:"Poor cleaning; plates must be rewashed.",
  actions:"Clean all jets before every wash; poke debris & flush; remove arms for thorough job."
 }
};

/* ------------ Essential-Check logic (unchanged) ------------ */
function v(n){var r=document.querySelector('input[name="'+n+'"]:checked');return r?r.value:"";}
function advice(){
 var a=[];if(v('dosingOn')==='No')a.push("Switch on the dosing unit.");
 if(v('dosingWorking')==='No')a.push("Repair or calibrate dosing equipment.");
 if(v('temps')==='No')a.push("Verify temperatures are within spec.");
 if(v('jets')==='No')a.push("Clear wash & rinse jets.");
 if(v('practice')==='No')a.push("Improve pre-scraping / racking.");
 if(v('detergent')==='No')a.push("Connect correct detergent & tubes.");
 if(v('titration')==='No')a.push("Perform detergent titration.");
 return a;
}
function updateAdvice(){
 var p=document.getElementById('checklistResult'), a=advice();
 p.innerHTML=a.length?"<h3>Checklist findings</h3><ul><li>"+a.join("</li><li>")+"</li></ul>"
                     :"<p>No obvious issues from the checklist.</p>";
 p.classList.add('show');
}
Array.prototype.forEach.call(document.querySelectorAll('.toggle input'),function(r){r.onchange=updateAdvice});
updateAdvice();

/* ------------ copy to clipboard ------------ */
document.getElementById('copyBtn').onclick=function(){
 var make=document.getElementById('mMake').value||"-";
 var model=document.getElementById('mModel').value||"-";
 var txt="Machine Make: "+make+"\nMachine Model: "+model+"\n";
 var qs=document.querySelectorAll('.qcard');
 for(var i=0;i<qs.length;i++){
   var num=i+1,q=qs[i].querySelector('p').textContent.replace(/^\d+\.\s*/,"").trim();
   txt+=num+". "+q+" - "+v(qs[i].getAttribute('data-key'))+"\n";
 }
 if(navigator.clipboard&&navigator.clipboard.writeText){
   navigator.clipboard.writeText(txt).then(function(){alert("Copied to clipboard!");},
                                           function(){legacy(txt);});
 }else{legacy(txt);}
};
function legacy(t){
 var ta=document.createElement('textarea');ta.value=t;document.body.appendChild(ta);
 ta.select();try{document.execCommand('copy');alert("Copied!");}
 catch(e){alert("Copy failed:\n\n"+t);}document.body.removeChild(ta);
}

/* ------------ Quick Symptom Lookup ------------ */
document.getElementById('symptom').onchange=function(){
 var key=(this.value||"").trim(), box=document.getElementById('symptomResult');
 if(!key){box.classList.remove('show');box.innerHTML="";return;}
 var d=DATA[key];
 if(!d){box.classList.remove('show');box.innerHTML="<em>No data found</em>";return;}
 box.innerHTML="<p><strong>Causes:</strong> "+d.causes+"</p>"+
               (d.consequences?"<p><strong>Consequences:</strong> "+d.consequences+"</p>":"")+
               "<p><strong>Possible solutions:</strong> "+d.actions+"</p>";
 box.classList.add('show');box.scrollIntoView({behavior:'smooth',block:'start'});
};
</script>
</body>
</html>
